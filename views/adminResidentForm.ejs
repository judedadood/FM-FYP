<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title><%= title %></title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    nav {
      background:#003366;
      padding:12px 25px;
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    nav .logo { font-weight:bold; font-size:20px; }
    nav ul { list-style:none; display:flex; gap:18px; margin:0; padding:0; }
    nav a { color:#fff; text-decoration:none; font-size:14px; }
    nav a:hover { text-decoration:underline; }
  </style>
</head>

<body class="bg-light">

<nav>
  <div class="logo">Condo Management System</div>
  <ul>
    <li><a href="/admin">Admin Dashboard</a></li>
    <li><a href="/admin/residents">Residents</a></li>
    <li><a href="/admin/payments">Payments</a></li>
    <li><a href="/logout">Logout</a></li>
  </ul>
</nav>

<div class="container my-5" style="max-width:700px;">
  <h2 class="mb-3"><%= title %></h2>

  <% if (error) { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>

  <%
    const modeSafe = (typeof mode !== "undefined" && mode) ? mode : "create";
    const formSafe = (typeof form !== "undefined" && form) ? form : {};
  %>

  <form action="<%= modeSafe === 'create'
                  ? '/admin/residents/new'
                  : '/admin/residents/' + (formSafe.resident_id || '') + '/edit' %>"
        method="POST"
        class="card shadow-sm">

    <div class="card-body">

      <div class="mb-3">
        <label class="form-label">Name</label>
        <input class="form-control" name="name" value="<%= formSafe.name || '' %>" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Email</label>
        <input class="form-control" name="email" type="email" value="<%= formSafe.email || '' %>" required>
      </div>

      <% if (modeSafe === 'create') { %>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input class="form-control" name="password" type="text" value="<%= formSafe.password || '' %>" required>
          <div class="form-text">This is the initial login password. It will be stored as a hash.</div>
        </div>
      <% } %>

      <div class="mb-3">
        <label class="form-label">Unit Number</label>
        <input class="form-control" name="unit_number" placeholder="e.g. 101"
               value="<%= formSafe.unit_number || '' %>" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Phone</label>
        <input class="form-control" name="phone" value="<%= formSafe.phone || '' %>" required>
      </div>

      <% if (modeSafe === 'edit') { %>
        <div class="mb-3">
          <label class="form-label">Status</label>
          <select class="form-control" name="status" required>
            <option value="Active" <%= (formSafe.status || 'Active') === 'Active' ? 'selected' : '' %>>Active</option>
            <option value="Inactive" <%= (formSafe.status || 'Active') === 'Inactive' ? 'selected' : '' %>>Inactive</option>
          </select>
        </div>
      <% } %>

      <div class="d-flex gap-2">
        <button class="btn btn-primary">
          <%= modeSafe === 'create' ? 'Create Resident' : 'Update Resident' %>
        </button>
        <a href="/admin/residents" class="btn btn-secondary">Cancel</a>
      </div>

    </div>
  </form>
</div>

</body>
</html>
